<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<style>
		body {
			font-family: Arial;
			background-color: rgb(22, 22, 22);
		}
	</style>
</head>
<body>
	<script>
/*
		//18a
		const xhr = new XMLHttpRequest();

		xhr.addEventListener('load', () => {
			console.log(xhr.response);
		})
		xhr.open('GET', 'https://supersimplebackend.dev/greeting');
		xhr.send();

		//18b
		fetch('https://supersimplebackend.dev/greeting').then((response) => {
			return response.text();
		}).then((text) => {
			console.log(text);
		});

		//18c
		async function gereeting() {
			const response = await fetch('https://supersimplebackend.dev/greeting');
			const text = await response.text();
			console.log(text);
		}
		gereeting();

		//18d
		async function greetingFetch() {
			try {
				const response = await fetch('https://supersimplebackend.dev/greeting', {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json'
					},
					body: JSON.stringify({
						name: "Izumi Miyamora"
					})
				});

				const greet = await response.text();
				console.log(greet);
			} catch (error) {
				console.log('Unexpected error! Please try again after sometime');
			}
		}
		greetingFetch();

		//18ef
		async function amazon() {
			try {
				const response = await fetch ('https://amazon.com');
				const text = await response.text();
				console.log(text);
			} catch(error) {
				console.log('CORS error. Your request was blocked by the backend.');
			}
		}
		amazon();
*/

		//18g
		async function postGreeting() {
			try {
				const response = await fetch('https://supersimplebackend.dev/greeting', {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json'
					},
					// body: JSON.stringify({
					// 	name: "Izumi Miyamora"
					// })
				});

				if (response.status >= 400) {
					throw response;
				}

				const greet = await response.text();
				console.log(greet);

			} catch (error) {
				if(error.status === 400) {
					const errorMsg = await error.json();
					console.log(errorMsg);
				} else {
					console.log('Network error. Please try again later');
				}
			}
		}
		postGreeting();
	</script>
</body>
</html>